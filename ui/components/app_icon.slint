import { Theme } from "theme.slint";

export component AppIcon inherits Rectangle {
    in property <string> label: "";
    in property <image> icon;
    in property <bool> compact: false;

    callback activated(string);

    background: #00000000;
    clip: true;

    out property <bool> pressed: false;

    // Subtle press feedback (no card/background).
    Rectangle {
        property <length> size: root.compact ? 76px : 60px;
        x: (parent.width - self.size) / 2;
        y: root.compact ? 6px : 8px;
        width: self.size;
        height: self.size;
        border-radius: 12px;
        background: Theme.focus_ring;
        opacity: root.pressed ? 1.0 : 0.0;
        animate opacity { duration: Theme.anim_fast; }
    }

    Image {
        property <length> img_size: root.compact ? 66px : 52px;
        x: (parent.width - self.img_size) / 2;
        y: root.compact ? 8px : 10px;
        width: self.img_size;
        height: self.img_size;
        source: root.icon;
        image-fit: contain;
        opacity: root.pressed ? 0.85 : 1.0;
        animate opacity { duration: Theme.anim_fast; }
    }

    Text {
        x: 6px;
        y: parent.height - (root.compact ? 18px : 22px);
        width: parent.width - 12px;
        height: root.compact ? 14px : 16px;
        text: root.label;
        color: Theme.text_dim;
        font-size: root.compact ? Theme.font_xs : Theme.font_sm;
        font-weight: 500;
        horizontal-alignment: center;
        vertical-alignment: center;
    }

    TouchArea {
        width: parent.width;
        height: parent.height;
        pointer-event(event) => {
            if (event.button != PointerEventButton.left) { return; }
            if (event.kind == PointerEventKind.down) {
                root.pressed = true;
            } else if (event.kind == PointerEventKind.up || event.kind == PointerEventKind.cancel) {
                root.pressed = false;
            }
        }
        clicked => { root.activated(root.label); }
    }
}
