# Codex агент: принципы работы в этом репо

Цель: собирать BlackBerry‑styled UI на Slint “по кусочкам”, при этом держать код production‑grade (структура, токены, управляемые состояния, отсутствие случайных регрессий).

## Workflow

- Работать маленькими вертикальными срезами: 1 запрос пользователя = 1 логически завершённый кусочек UI/логики.
- После каждого запроса пользователя: **делать git commit** с кратким сообщением.
- Перед коммитом: `cargo build` (или более узкая проверка, если появится тестовая инфраструктура).
- Не раздувать scope: не чинить “попутные” вещи без запроса.

## Структура UI

- `ui/app.slint` — корневой `AppWindow`, композиция экранов/оверлеев (status bar, lock, desktop, shade).
- `ui/components/` — все компоненты, только одно назначение на файл.
- `ui/components/bb_theme.slint` — “источник правды” токенов (палитры, размеры, длительности).
- `ui/components/theme.slint` — стабильный алиас `Theme` для импортов во всех компонентах.

## Токены и темы

- Любые цвета/размеры/анимации берутся из `Theme`, а не хардкодятся в компонентах.
- Должно быть две темы: Light и Dark. Light — по умолчанию.
- Токены проектируются заранее, чтобы потом менять стиль централизованно.

## Анимации и reduce motion

- Все анимации должны уважать `reduce_motion`:
  - если `reduce_motion=true` — длительность `0ms` и никаких бесконечных таймеров/loop‑анимаций.
  - параметр приходит из Rust в `AppWindow.reduce_motion`.
- Для интерактива: анимации должны быть детерминированными (без накопления дрейфа), предсказуемыми по длительностям.

## Жесты и hit-testing

- Нельзя “накрывать” интерактивные элементы глобальными gesture‑обработчиками:
  - жесты (swipe) размещать только там, где они нужны (например, “шапка” шторки),
  - иначе TouchArea/SwipeGestureHandler будет съедать клики кнопок/слайдеров.
- Для “следует за пальцем”:
  - во время drag отключать анимацию (duration `0ms`), а по отпусканию делать “прищёлкивание” с easing.

## Связь Rust ↔ Slint

- Все состояния приложения — через `in-out property` в `AppWindow`.
- Rust отвечает за системные данные (время/дата, reduce_motion, будущие уведомления/сеть/батарея).
- Slint отвечает за презентацию и локальные UI‑состояния (pressed, hover, визуальные переходы).

## Качество

- Публичные API компонентов минимальны и стабильны (не плодить свойства без нужды).
- Имена: `snake_case` для файлов, `PascalCase` для компонентов.
- Не добавлять лишние зависимости без явной причины.

